webpackJsonp([1],{"7zck":function(e,t){},"8r8y":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("//Fk"),a=n.n(s),o=n("HSQo"),i=n.n(o),r=n("7+uW"),u={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",{attrs:{id:"app"}},[t("iframe",{staticClass:"frame",attrs:{src:"https://www.thecloudgate.co.kr/"}}),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var c=n("VU/8")({name:"App"},u,!1,function(e){n("PpXH")},null,null).exports,l=n("/ocq"),d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"userBtn"},[t("v-btn",{staticClass:"btn",attrs:{color:"#4caf50",fab:"",dark:"",large:""},on:{click:this.openRtc}},[t("v-icon",[this._v("mdi-cellphone")])],1)],1)},staticRenderFns:[]};var m=n("VU/8")({name:"Index",data:function(){return{}},methods:{openRtc:function(){this.$janus.send({message:{request:"register",username:"user"}}),this.$router.push("/user")}},mounted:function(){}},d,!1,function(e){n("UZN8")},null,null).exports,v={name:"User",data:function(){return{doSimulcast:null,spinner:null,video:!1,dim:!1,text:"",msgList:[]}},methods:{hangup:function(){this.$janus.send({message:{request:"hangup"}}),this.$janus.hangup(),this.$router.push("/")},scrollBtm:function(){var e=document.querySelector(".txtBox ul");e.scrollTo(0,e.scrollHeight)},checkEnter:function(e){var t=this;if("Enter"===e.code){if(""===this.text)return;this.$janus.data({text:this.text,success:function(){t.msgList.push({type:"p",text:t.text}),t.text="",setTimeout(function(){t.scrollBtm()},10)}})}},call:function(){var e=this;this.$janus.createOffer({media:{data:!0},simulcast:this.doSimulcast,success:function(t){console.log(e,t),window.Janus.debug("Got SDP!",t);e.$janus.send({message:{request:"call",username:"manager"},jsep:t})},error:function(t){e.$janus.error("WebRTC error...",t)}})},getQueryStringValue:function(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},onlocal:function(e){window.Janus.attachMediaStream(document.getElementById("myvideo"),e),document.getElementById("myvideo").muted="muted"}},mounted:function(){var e=this;this.doSimulcast="yes"===this.getQueryStringValue("simulcast")||"true"===this.getQueryStringValue("simulcast"),this.$eventBus.$on("onmessage",function(t){"accepted"===t.msg.result.event&&t.jsep&&e.$janus.handleRemoteJsep({jsep:t.jsep}),"calling"===t.msg.result.event&&(e.dim=!0)}),this.$eventBus.$on("onlocalstream",function(t){e.video=!0,e.onlocal(t)}),this.$eventBus.$on("onremotestream",function(t){e.dim=!1,window.Janus.attachMediaStream(document.getElementById("remotevideo"),t)}),this.$eventBus.$on("ondata",function(t){e.msgList.push({type:"a",text:t}),setTimeout(function(){e.scrollBtm()},10)})}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userLayout"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.video,expression:"!video"}],staticClass:"confirm"},[n("p",[e._v("연결하시겠습니까?")]),e._v(" "),n("v-btn",{attrs:{dark:"",color:"#5cbbf6"},on:{click:e.call}},[e._v("CALL")])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.video,expression:"video"}],staticClass:"video"},[n("video",{staticClass:"rounded centered",attrs:{id:"myvideo",autoplay:"",playsinline:"",muted:"muted"},domProps:{muted:!0}}),e._v(" "),n("video",{staticClass:"rounded centered",attrs:{id:"remotevideo",autoplay:"",playsinline:""}}),e._v(" "),n("div",{staticClass:"txtBox"},[n("ul",e._l(e.msgList,function(t,s){return n("li",{key:s,class:{p:"p"===t.type,a:"a"===t.type}},["p"===t.type?n("v-icon",{attrs:{color:"green"}},[e._v("mdi-account-circle")]):e._e(),e._v(" "+e._s(t.text)+" "),"a"===t.type?n("v-icon",{attrs:{color:"#6a9aca"}},[e._v("mdi-account-circle")]):e._e()],1)}),0),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],attrs:{type:"text",value:"test",placeholder:"메시지를 입력해주세요."},domProps:{value:e.text},on:{keyup:e.checkEnter,input:function(t){t.target.composing||(e.text=t.target.value)}}}),e._v(" "),n("div",{staticClass:"close"},[n("v-btn",{attrs:{depressed:"",small:"",color:"error"},on:{click:e.hangup}},[e._v("Hangup")])],1)])]),e._v(" "),e.dim?n("div",{staticClass:"dim"},[n("v-progress-circular",{attrs:{indeterminate:"",width:3,color:"#fff"}})],1):e._e()])},staticRenderFns:[]};var g=n("VU/8")(v,p,!1,function(e){n("8r8y")},null,null).exports,h={name:"Manager",data:function(){return{callPopup:!1,spinner:null,username:"",jsep:null,text:"",msgList:[]}},methods:{hangup:function(){this.$janus.send({message:{request:"hangup"}}),this.$janus.hangup()},checkEnter:function(e){var t=this;if("Enter"===e.code){if(""===this.text)return;this.$janus.data({text:this.text,success:function(){t.msgList.push({type:"p",text:t.text}),t.text=""}})}},doCall:function(){var e=this;console.log(this.jsep),this.$janus.createAnswer({jsep:this.jsep,media:{data:!0},simulcast:this.doSimulcast,success:function(t){console.log(t),window.Janus.debug("Got SDP!",t);e.$janus.send({message:{request:"accept"},jsep:t}),e.callPopup=!1},error:function(e){window.Janus.error("WebRTC error:",e)}})},decline:function(){this.$janus.send({message:{request:"hangup"}}),this.$janus.hangup(),this.callPopup=!1},getQueryStringValue:function(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},onlocal:function(e){window.Janus.debug(" ::: Got a local stream :::",e),window.Janus.attachMediaStream(document.getElementById("myvideo"),e)}},mounted:function(){var e=this;this.doSimulcast="yes"===this.getQueryStringValue("simulcast")||"true"===this.getQueryStringValue("simulcast"),this.$janus.send({message:{request:"register",username:"manager"}}),this.$eventBus.$on("onmessage",function(t){var n=t.msg.result.event;e.username=t.msg.result.username,t.jsep&&(e.jsep=t.jsep),"incomingcall"===n&&(e.callPopup=!0)}),this.$eventBus.$on("onlocalstream",function(t){e.onlocal(t)}),this.$eventBus.$on("onremotestream",function(e){window.Janus.attachMediaStream(document.getElementById("remotevideo"),e)}),this.$eventBus.$on("ondata",function(t){e.msgList.push({type:"a",text:t})})}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"manager"},[n("div",{staticClass:"videoBox"},[n("div",{staticClass:"video"},[n("div",{staticClass:"box"},[n("div",{staticClass:"line"},[n("div",{staticClass:"tit"},[e._v("Local Stream")]),e._v(" "),n("video",{staticClass:"rounded centered",attrs:{id:"myvideo",autoplay:"",playsinline:"",muted:"muted"},domProps:{muted:!0}})])]),e._v(" "),e._m(0)]),e._v(" "),n("div",{staticClass:"msgBox"},[n("ul",e._l(e.msgList,function(t,s){return n("li",{key:s,class:{p:"p"===t.type,a:"a"===t.type}},["p"===t.type?n("v-icon",{attrs:{color:"green"}},[e._v("mdi-account-circle")]):e._e(),e._v(" "+e._s(t.text)+" "),"a"===t.type?n("v-icon",{attrs:{color:"#6a9aca"}},[e._v("mdi-account-circle")]):e._e()],1)}),0),e._v(" "),n("div",{staticClass:"input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],attrs:{type:"text",value:"test",placeholder:"메시지를 입력해주세요."},domProps:{value:e.text},on:{keyup:e.checkEnter,input:function(t){t.target.composing||(e.text=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"close"},[n("v-btn",{attrs:{depressed:"",small:"",color:"error"},on:{click:e.hangup}},[e._v("Hangup")])],1)])]),e._v(" "),n("v-dialog",{attrs:{width:"500"},model:{value:e.callPopup,callback:function(t){e.callPopup=t},expression:"callPopup"}},[n("v-card",[n("div",{staticClass:"txtPop"},[n("strong",[e._v(e._s(e.username)+"님")]),e._v("으로부터 영상 통화 요청이 왔습니다.\n      ")]),e._v(" "),n("v-divider"),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.doCall}},[e._v("\n          Answer\n        ")]),e._v(" "),n("v-btn",{attrs:{color:"error",text:""},on:{click:e.decline}},[e._v("\n          Decline\n        ")])],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"box notPad"},[t("div",{staticClass:"line"},[t("div",{staticClass:"tit"},[this._v("Remote Stream")]),this._v(" "),t("video",{staticClass:"rounded centered",attrs:{id:"remotevideo",autoplay:"",playsinline:""}})])])}]};var w=n("VU/8")(h,f,!1,function(e){n("yk+u")},null,null).exports;r.default.use(l.a);var _=new l.a({routes:[{path:"/",name:"Index",component:m},{path:"/user",name:"User",component:g},{path:"/manager",name:"Manager",component:w}]}),y=n("3EgV"),x=n.n(y);n("7zck");r.default.use(x.a);var $=new x.a({}),C=new r.default;i()(r.default.prototype,{$eventBus:{get:function(){return C}}});r.default.config.productionTip=!1,window.getJanus=null,new a.a(function(e){var t=window.Janus,n=void 0;t.init({debug:!0,callback:function(){var s=t.randomString(12);n=new window.Janus({server:"https://ticket.thecloudgate.io:8089/janus",success:function(){n.attach({plugin:"janus.plugin.videocall",opaqueId:"videocalltest-"+s,success:function(t){e(t)},error:function(e){window.Janus.error("  -- Error attaching plugin...",e)},consentDialog:function(e){window.Janus.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){window.Janus.log("ICE state changed to "+e)},mediaState:function(e,t){window.Janus.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){window.Janus.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},onmessage:function(e,t){console.log("onmessage ::: Got a local stream :::",e,t),C.$eventBus.$emit("onmessage",{msg:e,jsep:t}),window.Janus.debug(" ::: Got a message :::",e)},onlocalstream:function(e){C.$eventBus.$emit("onlocalstream",e),console.log("onlocalstream ::: Got a local stream :::",e)},onremotestream:function(e){C.$eventBus.$emit("onremotestream",e),console.log("onremotestream ::: Got a remote stream :::",e)},ondataopen:function(e){window.Janus.log("The DataChannel is available!")},ondata:function(e){C.$eventBus.$emit("ondata",e),window.Janus.debug("We got data from the DataChannel!",e)},oncleanup:function(){window.Janus.log(" ::: Got a cleanup notification :::")}})},error:function(e){window.Janus.error(e)}})}})}).then(function(e){r.default.prototype.$janus=e,new r.default({el:"#app",router:_,vuetify:$,components:{App:c},template:"<App/>"})})},PpXH:function(e,t){},UZN8:function(e,t){},"yk+u":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c2f1807a5dcd4d1f6936.js.map